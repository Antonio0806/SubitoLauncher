{"version":3,"sources":["webpack:///./app/components/JavaGlobalOptionsFixModal/JavaGlobalOptionsFixModal.js","webpack:///./app/components/JavaGlobalOptionsFixModal/JavaGlobalOptionsFixModal.scss"],"names":["props","unMount","setUnMount","useState","fixing","setFixing","finished","setFinished","useEffect","store","set","history","title","style","height","width","className","styles","restartBtn","type","onClick","async","remote","app","quit","Fragment","main","buttons","loading","platform","WINDOWS","stdout","stderr","promisify","exec","name","err","includes","message","warn","log","error","childProcess","module","exports"],"mappings":"4rCA+EY,kD,EACA,kFAEE,WAFF,kB,EAiBqD,W,EAAO,W,EAE7C,W,EAAO,W,EAGtB,W,EACA,W,EAAO,W,EACP,W,EACA,kBACE,qCADF,6CAEE,0BAFF,MA1FGA,cACb,MAAOC,EAASC,GAAcC,oBAAS,IAChCC,EAAQC,GAAaF,oBAAS,IAC9BG,EAAUC,GAAeJ,oBAAS,GAEzCK,oBAAU,KACRC,IAAMC,IAAI,8BAA8B,IACvC,IA+CH,OACE,EAAC,IAAD,CACEC,QAASX,EAAMW,QACfV,QAASA,EACTW,MAAM,uCACNC,MAAO,CAAEC,OAAQ,IAAKC,MAAO,WAJ/B,GAMgB,IAAbT,EACC,SAAKU,UAAWC,IAAOX,eAAvB,EACE,sBAME,EAAC,IAAD,CACEU,UAAWC,IAAOC,WAClBC,KAAK,UACLC,QAtBIC,UACdC,SAAOC,IAAIC,cAkBH,qBAUJ,EAAC,IAAMC,SAAP,UACE,SAAKT,UAAWC,IAAOS,WAAvB,wWAeA,SAAKV,UAAWC,IAAOU,cAAvB,EACE,UAAMP,QAAS,IAAOhB,EAAS,KAAOF,GAAW,SAAjD,4BAGA,EAAC,IAAD,CAAQiB,KAAK,UAAUS,QAASxB,EAAQgB,QA1F3BC,UAGrB,GAFAhB,GAAU,GACVI,IAAMC,IAAI,8BAA8B,GACpCmB,uBAAeC,IACjB,IAEE,MAAM,OAAEC,EAAF,OAAUC,SAAiBC,oBAAUC,OAAVD,CAC9B,0GACD,CAAEE,KAAM,8BAEV,MAAOC,GACP,GACiB,iBAARA,GACPA,EAAIC,SAAS,iCAKb,OAHAC,IAAQC,KAAK,6CACblC,GAAU,QACVmC,IAAIC,MAAML,GAGZI,IAAIC,MAAML,EAAIE,SAhBhB,QAkBE,IAEE,MAAM,OAAEP,EAAF,OAAUC,SAAiBC,oBAAUS,IAAaR,KAAvBD,CAC/B,4EAEF,aAGJ,IAEE,MAAM,OAAEF,EAAF,OAAUC,SAAiBC,oBAAUS,IAAaR,KAAvBD,CAC/B,uBAEF,OAEJ5B,GAAU,GACVE,GAAY,UAoDJ,sB,4FCjHZoC,EAAOC,QAAU,CAAC,QAAU,UAAU,IAAM,UAAU,MAAQ,UAAU,OAAS,UAAU,gBAAkB,UAAU,gBAAkB,UAAU,gBAAkB,UAAU,oBAAsB,UAAU,KAAO,0BAA0B,QAAU,0BAA0B,SAAW,0BAA0B,WAAa","file":"11.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { message, Button } from 'antd';\nimport log from 'electron-log';\nimport { platform } from 'os';\nimport { remote } from 'electron';\nimport { exec } from 'sudo-prompt';\nimport childProcess from 'child_process';\nimport { promisify } from 'util';\nimport store from '../../localStore';\nimport styles from './JavaGlobalOptionsFixModal.scss';\nimport Modal from '../Common/Modal/Modal';\nimport { PACKS_PATH, WINDOWS } from '../../constants';\n\ntype Props = {};\n\nexport default props => {\n  const [unMount, setUnMount] = useState(false);\n  const [fixing, setFixing] = useState(false);\n  const [finished, setFinished] = useState(false);\n\n  useEffect(() => {\n    store.set('showGlobalOptionsJavaModal', false);\n  }, []);\n\n  const fixJavaProblem = async () => {\n    setFixing(true);\n    store.set('showGlobalOptionsJavaModal', true);\n    if (platform() === WINDOWS) {\n      try {\n        // Deletes the _JAVA_OPTIONS from the system register\n        const { stdout, stderr } = await promisify(exec)(\n          `REG delete \"HKLM\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Environment\" /F /V _JAVA_OPTIONS`,\n          { name: 'SubitoLauncher Java Fixer' }\n        );\n      } catch (err) {\n        if (\n          typeof err === 'string' &&\n          err.includes('User did not grant permission')\n        ) {\n          message.warn('You need to confirm UAC dialog to proceed');\n          setFixing(false);\n          log.error(err);\n          return;\n        }\n        log.error(err.message);\n      } finally {\n        try {\n          // Removes the _JAVA_OPTIONS and sets it to empty in the user registry to apply it without rebooting\n          const { stdout, stderr } = await promisify(childProcess.exec)(\n            'SETX _JAVA_OPTIONS \"\" & REG delete HKCU\\\\Environment /F /V _JAVA_OPTIONS'\n          );\n        } catch {}\n      }\n    } else {\n      try {\n        // unset _JAVA_OPTIONS should be enough\n        const { stdout, stderr } = await promisify(childProcess.exec)(\n          'unset _JAVA_OPTIONS'\n        );\n      } catch {}\n    }\n    setFixing(false);\n    setFinished(true);\n  };\n\n  const quitApp = async () => {\n    remote.app.quit();\n  };\n\n  return (\n    <Modal\n      history={props.history}\n      unMount={unMount}\n      title=\"Java Problem Detected: _JAVA_OPTIONS\"\n      style={{ height: 400, width: 650 }}\n    >\n      {finished === true ? (\n        <div className={styles.finished}>\n          <div>\n            <h1>All Done! We Fixed The Issue!</h1>\n            <div>\n              For changes to apply you need to manually reopen the launcher\n              <br /> Happy Gaming!\n            </div>\n            <Button\n              className={styles.restartBtn}\n              type=\"primary\"\n              onClick={quitApp}\n            >\n              Exit Launcher\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <React.Fragment>\n          <div className={styles.main}>\n            Hey, we are sorry to tell you that we found a problem in your java\n            installation. The good news is that we can fix it ðŸ˜„ <br /> <br />\n            We highly recommend fixing it since it can cause multiple errors\n            with the game. <br /> <br />\n            Do you want us to unset the _JAVA_OPTIONS global variable from your\n            system?\n            <br /> We may ask for Administrator Privileges\n            <br /> <br />\n            <br />\n            <div>\n              <b>If you are unsure</b> about what _JAVA_OPTIONS is, just click \"\n              <b>Fix It</b>\".\n            </div>\n          </div>\n          <div className={styles.buttons}>\n            <span onClick={() => (fixing ? null : setUnMount(true))}>\n              No, I Like It This Way\n            </span>\n            <Button type=\"primary\" loading={fixing} onClick={fixJavaProblem}>\n              Yes, Fix It\n            </Button>\n          </div>\n        </React.Fragment>\n      )}\n    </Modal>\n  );\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"primary\":\"#2980b9\",\"red\":\"#c0392b\",\"green\":\"#27ae60\",\"yellow\":\"#f39c12\",\"secondarycolor1\":\"#34495e\",\"secondarycolor2\":\"#2c3e50\",\"secondarycolor3\":\"#212b36\",\"secondarycolorlight\":\"#4a6075\",\"main\":\"_2JXdRnkGy_7jA9Um6l67mw\",\"buttons\":\"_1v5pAdBNUf_iD9obq2JbSD\",\"finished\":\"_1PIj7QBkzcN7DIyUqwFcMk\",\"restartBtn\":\"_2ZPfvSijWl_h0CKfKOu-ae\"};"],"sourceRoot":""}